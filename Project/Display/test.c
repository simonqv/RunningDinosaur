#include <stdlib.h>
#include <stdio.h>

// void add_obstacle(int x_cordinate, int y_cordinate, const int** board, const int** obstacle) {
// 	int row,col,i;
// 	for(row = y_cordinate; row < oled_y; row++){
// 		for(col = x_cordinate; col < oled_x; col++){
// 			//board[row][col] = obstacle[0][i];
// 			int j=1;
// 		}
// 	}
// }

int pow2(int base, int exp)
    {
      if(exp < 0)
        return -1;
        int result = 1;
        while (exp)
        {
            if (exp & 1)
                result *= base;
            exp >>= 1;
            base *= base;
        }
        return result;
    }

int main() {

    char board[128][32] = {
                            {"00000000000000000000000000000010"},
                            {"00000000000000000000000000000010"},
                            {"00000000000000000000000000000010"},
                            {"00000000000000000000000000000010"},
                            {"00000000000000000000000000000010"},
                            {"00000000000000000000000000000010"},
                            {"00000000000000000000000000000010"},
                            {"00000000000000000000000000000010"},
                            {"00000000000000000000000000000010"},
                            {"00000000000000000000000000000010"},
                            {"00000000000000000000000000000010"},
                            {"00000000000000000000000000000010"},
                            {"00000000000000000000000000000010"},
                            {"00000000000000000000000000000010"},
                            {"00000000000000000000000000000010"},
                            {"00000000000000000000000000000010"},
                            {"00000000000000000000000000000010"},
                            {"00000000000000000000000000000010"},
                            {"00000000000000000000000000000010"},
                            {"00000000000000000000000000000010"},
                            {"00000000000000000000000000000010"},
                            {"00000000000000000000000000000010"},
                            {"00000000000000000000000000000010"},
                            {"00000000000000000000000000000010"},
                            {"00000000000000000000000000000010"},
                            {"00000000000000000000000000000010"},
                            {"00000000000000000000000000000010"},
                            {"00000000000000000000000000000010"},
                            {"00000000000000000000000000000010"},
                            {"00000000000000000000000000000010"},
                            {"00000000000000000000000000000010"},
                            {"00000000000000000000000000000010"},
                            {"00000000000000000000000000000010"},
                            {"00000000000000000000000000000010"},
                            {"00000000000000000000000000000010"},
                            {"00000000000000000000000000000010"},
                            {"00000000000000000000000000000010"},
                            {"00000000000000000000000000000010"},
                            {"00000000000000000000000000000010"},
                            {"00000000000000000000000000000010"},
                            {"00000000000000000000000000000010"},
                            {"00000000000000000000000000000010"},
                            {"00000000000000000000000000000010"},
                            {"00000000000000000000000000000010"},
                            {"00000000000000000000000000000010"},
                            {"00000000000000000000000000000010"},
                            {"00000000000000000000000000000010"},
                            {"00000000000000000000000000000010"},
                            {"00000000000000000000000000000010"},
                            {"00000000000000000000000000000010"},
                            {"00000000000000000000000000000010"},
                            {"00000000000000000000000000000010"},
                            {"00000000000000000000000000000010"},
                            {"00000000000000000000000000000010"},
                            {"00000000000000000000000000000010"},
                            {"00000000000000000000000000000010"},
                            {"00000000000000000000000000000010"},
                            {"00000000000000000000000000000010"},
                            {"00000000000000000000000000000010"},
                            {"00000000000000000000000000000010"},
                            {"00000000000000000000000000000010"},
                            {"00000000000000000000000000000010"},
                            {"00000000000000000000000000000010"},
                            {"00000000000000000000000000000010"},
                            {"00000000000000000000000000000010"},
                            {"00000000000000000000000000000010"},
                            {"00000000000000000000000000000010"},
                            {"00000000000000000000000000000010"},
                            {"00000000000000000000000000000010"},
                            {"00000000000000000000000000000010"},
                            {"00000000000000000000000000000010"},
                            {"00000000000000000000000000000010"},
                            {"00000000000000000000000000000010"},
                            {"00000000000000000000000000000010"},
                            {"00000000000000000000000000000010"},
                            {"00000000000000000000000000000010"},
                            {"00000000000000000000000000000010"},
                            {"00000000000000000000000000000010"},
                            {"00000000000000000000000000000010"},
                            {"00000000000000000000000000000010"},
                            {"00000000000000000000000000000010"},
                            {"00000000000000000000000000000010"},
                            {"00000000000000000000000000000010"},
                            {"00000000000000000000000000000010"},
                            {"00000000000000000000000000000010"},
                            {"00000000000000000000000000000010"},
                            {"00000000000000000000000000000010"},
                            {"00000000000000000000000000000010"},
                            {"00000000000000000000000000000010"},
                            {"00000000000000000000000000000010"},
                            {"00000000000000000000000000000010"},
                            {"00000000000000000000000000000010"},
                            {"00000000000000000000000000000010"},
                            {"00000000000000000000000000000010"},
                            {"00000000000000000000000000000010"},
                            {"00000000000000000000000000000010"},
                            {"00000000000000000000000000000010"},
                            {"00000000000000000000000000000010"},
                            {"00000000000000000000000000000010"},
                            {"00000000000000000000000000000010"},
                            {"00000000000000000000000000000010"},
                            {"00000000000000000000000000000010"},
                            {"00000000000000000000000000000010"},
                            {"00000000000000000000000000000010"},
                            {"00000000000000000000000000000010"},
                            {"00000000000000000000000000000010"},
                            {"00000000000000000000000000000010"},
                            {"00000000000000000000000000000010"},
                            {"00000000000000000000000000000010"},
                            {"00000000000000000000000000000010"},
                            {"00000000000000000000000000000010"},
                            {"00000000000000000000000000000010"},
                            {"00000000000000000000000000000010"},
                            {"00000000000000000000000000000010"},
                            {"00000000000000000000000000000010"},
                            {"00000000000000000000000000000010"},
                            {"00000000000000000000000000000010"},
                            {"00000000000000000000000000000010"},
                            {"00000000000000000000000000000010"},
                            {"00000000000000000000000000000010"},
                            {"00000000000000000000000000000010"},
                            {"00000000000000000000000000000010"},
                            {"00000000000000000000000000000010"},
                            {"00000000000000000000000000000010"},
                            {"00000000000000000000000000000010"},
                            {"00000000000000000000000000000010"},
                            {"00000000000000000000000000000010"},
                            {"00000000000000000000000000000010"}
};
    int BOARD_WIDTH=128;
    int BOARD_HEIGHT=32;

    char bob[9][9] = {
                            {"000011100"},
                            {"000110000"},
                            {"101111101"},
                            {"011011111"},
                            {"001111100"},
                            {"011011111"},
                            {"101111101"},
                            {"000110000"},
                            {"000011100"}
    };
    int BOB_WIDTH=9;
    int BOB_HEIGHT=9;

    int x,y;
    //char **boardptr;

    //1. Allocate memory for boardptr
    /*boardptr = malloc(BOARD_WIDTH*sizeof(char*));
    for (x=0;x<BOARD_WIDTH;x++)
      (boardptr)[x] = malloc(BOARD_HEIGHT*sizeof(char));*/
    char boardptr[128][32];


    //2. Make copy of board
    for (x=0;x<BOARD_WIDTH;x++){
      for (y=0;y<BOARD_HEIGHT;y++)
        boardptr[x][y]=board[x][y];
    }

    //3. Add bob into board into posx and posy
    int posx=0;
    int posy=32-BOB_HEIGHT-2;
    for (x=0;x<BOB_HEIGHT;x++){
      for (y=0;y<BOB_WIDTH;y++)
        boardptr[x+posx][y+posy]=bob[x][y];
    }

    //4. Turn boardptr into uint8_t
    //int **board_to_print;

    //4.1 Allocate memory for board_to_print
    //board_to_print = malloc(128*sizeof(int*));
    //for (x=0;x<128;x++)
    //  (board_to_print)[x] = malloc(4*sizeof(int));
    int board_to_print[128][4];

    int c,res;
    int i,z,p;

    for (y=0,p=0;y<BOARD_HEIGHT;y+=8,p++){
        for (x=0;x<BOARD_WIDTH;x++){
          res=0;
          for (i=0;i<8;i++){
            c=(int)boardptr[x][y+i];
            if (c==48){
              c=0;
            } else {
              c=1;
            }
            res+=c*(pow2(2,(7-i)));
          }
          board_to_print[x][p]=res;
      }
    }

    for (y = 0; y < 4; y++){
      for (x = 0; x < 128; x++){

        int val = (*(*(board_to_print + x) + y));
        printf("%d",val);

      }
      printf("\n");
    }

    //don't touch
    for (y = 0; y < BOARD_HEIGHT; y++){
      for (x = 0; x < BOARD_WIDTH; x++){

        char val = (*(*(boardptr + x) + y));
        if (val == '0'){val=' ';}
        printf("%c",val);

      }
      printf("\n");
    }

    //free(boardptr);
    //free(board_to_print);
    return 0;
}
